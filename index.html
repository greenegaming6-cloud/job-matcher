<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Job Vacancy Suggester</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif; background:#f8f9fa; color:#333; line-height:1.6; padding:20px; }

header { text-align:center; margin-bottom:30px; }
header h1 { font-size:2.2em; font-weight:600; color:#1d3557; }
header p { font-size:1em; color:#555; }

.search-container { display:flex; justify-content:center; margin:20px auto; gap:10px; max-width:700px; flex-wrap:wrap; }
.search-container input { flex:1; min-width:150px; padding:12px; font-size:1em; border:1px solid #ccc; border-radius:8px; }
.search-container button { padding:12px 20px; font-size:1em; background:#1d3557; color:#fff; border:none; border-radius:8px; cursor:pointer; transition:background 0.3s ease; }
.search-container button:hover { background:#457b9d; }

#results { margin-top:30px; display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; }

.job-card {
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 12px;
  padding: 18px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
.job-card:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0,0,0,0.15); }

.job-card h3 { color:#1d3557; font-size:1.2em; margin-bottom:6px; }
.job-card p { margin:4px 0; font-size:0.95em; color:#444; }
.job-card .summary { font-style: italic; color:#555; margin:6px 0; }
.job-card .quick-tip { margin-top:6px; font-size:0.9em; color:#1d3557; }
.job-card a {
  display:inline-block; margin-top:10px; padding:10px 16px;
  background:#457b9d; color:#fff; text-decoration:none; border-radius:6px;
  font-size:0.9em; transition:background 0.3s ease; text-align:center; cursor:pointer;
}
.job-card a:hover { background:#1d3557; }

.modal {
  display: none;
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  justify-content:center;
  align-items:center;
  z-index:1000;
}
.modal-content {
  background:#fff;
  padding:25px 30px;
  border-radius:12px;
  max-width:650px;
  width:90%;
  max-height:80%;
  overflow-y:auto;
  position:relative;
  box-shadow:0 5px 15px rgba(0,0,0,0.3);
}
.close-btn { position:absolute; top:10px; right:15px; font-size:1.8em; cursor:pointer; color:#e63946; }
.modal h2 { color:#1d3557; margin-bottom:12px; }
.modal p { margin:8px 0; line-height:1.5; }
</style>
</head>
<body>
<header>
  <h1>AI Job Vacancy Suggester</h1>
  <p>Find the latest job opportunities tailored to your skills</p>
</header>

<div class="search-container">
  <input id="query" placeholder="Enter job title or skill...">
  <input id="location" placeholder="Enter city or state...">
  <button onclick="getJobs()">Search</button>
</div>

<div id="results"></div>

<div id="jobModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal()">&times;</span>
    <div id="modalBody"></div>
  </div>
</div>

<script>
const ADZUNA_APP_ID = "d5c9c8ab"; 
const ADZUNA_APP_KEY = "b889fb91cf689c77061be60f5ee84020";
const OPENAI_KEY = "AIzaSyDRHrGsXZZ7x20_lM_WZ9PqiZvkqhRHCjg";  

let jobsArray = [];

async function getJobs() {
  const query = document.getElementById("query").value;
  const locationQuery = document.getElementById("location").value;
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "<p>üîé Searching jobs...</p>";

  try {
    const adzunaURL = `https://api.adzuna.com/v1/api/jobs/in/search/1?app_id=${ADZUNA_APP_ID}&app_key=${ADZUNA_APP_KEY}&results_per_page=5&what=${encodeURIComponent(query)}&where=${encodeURIComponent(locationQuery)}`;
    const jobRes = await fetch(adzunaURL);
    const jobData = await jobRes.json();

    if (!jobData.results || jobData.results.length === 0) {
      resultsDiv.innerHTML = "<p>‚ùå No jobs found.</p>";
      return;
    }

    resultsDiv.innerHTML = "";
    jobsArray = jobData.results;

    for (let i = 0; i < jobData.results.length; i++) {
      let job = jobData.results[i];

      // AI Summary
      let summary = "‚ö†Ô∏è No summary available";
      try {
        const summaryPrompt = `Summarize this job in simple words:\n\n${job.title}\n${job.description}`;
        const summaryRes = await fetch("https://api.openai.com/v1/responses", {
          method: "POST",
          headers: { "Authorization": `Bearer ${OPENAI_KEY}`, "Content-Type": "application/json" },
          body: JSON.stringify({ model: "gpt-4.1-mini", input: summaryPrompt })
        });
        const summaryData = await summaryRes.json();
        summary = summaryData.output[0].content[0].text || summary;
      } catch {}

      // City & State
      let city = job.location.area[1] || "Unknown";
      let state = job.location.area[2] || "Unknown";

      const div = document.createElement("div");
      div.className = "job-card";
      div.innerHTML = `
        <h3>üìå ${job.title}</h3>
        <p>üè¢ <b>Company:</b> ${job.company.display_name || "Unknown"}</p>
        <p>üìç <b>Location:</b> ${city}, ${state}</p>
        <p class="summary">üìù ${summary}</p>
        <a onclick="showModal(${i})">View Details</a>
      `;
      resultsDiv.appendChild(div);
    }
  } catch (err) {
    resultsDiv.innerHTML = "<p>‚ö†Ô∏è Error fetching jobs or summaries.</p>";
    console.error(err);
  }
}

async function showModal(index) {
  const job = jobsArray[index];
  const modal = document.getElementById("jobModal");
  const modalBody = document.getElementById("modalBody");

  let city = job.location.area[1] || "Unknown";
  let state = job.location.area[2] || "Unknown";

  modalBody.innerHTML = `
    <h2>üìå ${job.title}</h2>
    <p>üè¢ <b>Company:</b> ${job.company.display_name || "Unknown"}</p>
    <p>üìç <b>Location:</b> ${city}, ${state}</p>
    <p>üìù <b>Description:</b><br>${job.description || "No description available"}</p>
  `;

  modal.style.display = "flex";
}

function closeModal() {
  document.getElementById("jobModal").style.display = "none";
}

window.onclick = function(event) {
  const modal = document.getElementById("jobModal");
  if (event.target == modal) modal.style.display = "none";
}
</script>
</body>
</html>
